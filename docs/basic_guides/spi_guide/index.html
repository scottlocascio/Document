<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.50">


<title data-react-helmet="true">SPI Guide | WizFi360</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="SPI Guide | WizFi360"><meta data-react-helmet="true" name="description" content="## Introduction"><meta data-react-helmet="true" property="og:description" content="## Introduction"><meta data-react-helmet="true" name="keywords" content="WizFi360,SPI"><meta data-react-helmet="true" property="og:url" content="https://wizfi.github.io/Document/docs/basic_guides/spi_guide">

<link data-react-helmet="true" rel="shortcut icon" href="/Document/img/favicon.ico">


<link rel="stylesheet" href="/Document/styles.669b07ff.css">


<link rel="preload" href="/Document/styles.0ed8d793.js" as="script">

<link rel="preload" href="/Document/runtime~main.433e52dc.js" as="script">

<link rel="preload" href="/Document/main.ef26d2e9.js" as="script">

<link rel="preload" href="/Document/1.612e01d4.js" as="script">

<link rel="preload" href="/Document/2.b0a41411.js" as="script">

<link rel="preload" href="/Document/3.d193d8dc.js" as="script">

<link rel="preload" href="/Document/1be78505.d534d536.js" as="script">

<link rel="preload" href="/Document/2d31042b.173b4481.js" as="script">

<link rel="preload" href="/Document/17896441.83a3dab4.js" as="script">

<link rel="preload" href="/Document/62ef5692.8fdf17e9.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/Document/"><img class="navbar__logo" src="/Document/img/wizfi.png" alt="My Site Logo"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a activeclassname="navbar__link--active" class="navbar__item navbar__link">Docs</a><ul class="dropdown__menu"><li><a class="navbar__item navbar__link" href="/Document/docs/intro">WizFi360</a></li><li><a activeclassname="navbar__link--active" to="" class="navbar__item navbar__link">WizFi630</a></li></ul></div><a class="navbar__item navbar__link" href="/Document/blog">Blog</a><a target="_blank" rel="noopener noreferrer" href="https://wiznet.io" class="navbar__item navbar__link">Where to Buy</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/wizfi/Release/tree/master/Binary" class="navbar__item navbar__link">Download Firmware</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="/Document/img/all_guides.pdf">Download PDF</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://github.com/wizfi/Document" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/Document/"><img class="navbar__logo" src="/Document/img/wizfi.png" alt="My Site Logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a activeclassname="navbar__link--active" class="menu__link menu__link--sublist">Docs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Document/docs/intro">WizFi360</a></li><li class="menu__list-item"><a activeclassname="navbar__link--active" to="" class="menu__link">WizFi630</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/Document/blog">Blog</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://wiznet.io" class="menu__link">Where to Buy</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/wizfi/Release/tree/master/Binary" class="menu__link">Download Firmware</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="/Document/img/all_guides.pdf">Download PDF</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/wizfi/Document" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">WizFi360</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Document/docs/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/resources">Resources</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/wizfi360_shield">WizFi360-EVB-Shield</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/wizfi360_mini">WizFi360-EVB-Mini</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/wizfi360io">WizFi360io</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Application Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Basic Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/firmware_upgrade">Firmware Upgrade</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/Document/docs/basic_guides/spi_guide">SPI Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/mqtt_client">MQTT Client</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/hardware_design">Hardware Design Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/http_client">HTTP Client</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/http_server">HTTP Server</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/throughput">Throughput</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/w600sdk">W600-SDK</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/airkiss">Airkiss Configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/basic_guides/arduino_ide">Programming in Arduino IDE</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Connect to Cloud</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">MS Azure</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/standalone_mqtt">Standalone MQTT (한국어)</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/standalone_mqtt_e">Standalone MQTT</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/standalone_atcmd">Standalone AT Cmd (한국어)</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/standalone_atcmd_e">Standalone AT Cmd</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/mbed_mqtt">Mbed MQTT Cmd (한국어)</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/mbed_mqtt_e">Mbed MQTT Cmd</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/mbed_atcmd">Mbed AT Cmd (한국어)</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/mbed_atcmd_e">Mbed AT Cmd</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/arduino_atcmd">Arduino AT Cmd (한국어)</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/arduino_atcmd_e">Arduino AT Cmd</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/arduino_mqtt">Arduino MQTT (한국어)</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/arduino_mqtt_e">Arduino MQTT</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">AWS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/standalone_aws_atcmd">Standalone AT Cmd</a></li><li class="menu__list-item"><a class="menu__link" href="/Document/docs/connect_to_cloud/standalone_aws_atcmd_kr">Standalone AT Cmd (한국어)</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Other guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Document/docs/other_guides/location_tracker">Location Tracker</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">SPI Guide</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="introduction"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#introduction" title="Direct link to heading">#</a>Introduction</h2><p>WizFi360 operates in SPI slave mode and can be controlled via AT commands. In order to communicate with the MCU, the SPI pins must be connected and set the SPI_EN(PB13) pin to Low for SPI. Refer to Figure 1. WizFi360 Pinout to locate the SPI pins. Set the SPI_INT(PB14) pin to low when the user needs to send data from WizFi360 so that the SPI master can read the data.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="pinout"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#pinout" title="Direct link to heading">#</a>Pinout</h2><p>SPI pins are from PB13 to PB17 in the below Figure WizFi360 Pinout.</p><p><img src="/Document/img/basic_guides/spi_guide/wizfi360_pinout.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="spi-frame-format"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#spi-frame-format" title="Direct link to heading">#</a>SPI Frame Format</h2><p>WizFi360 is controlled by the SPI frame format sent from the SPI master. The SPI frame is controlled by CSn and composed of SPI Control Frame, AT CMD Frame, and DATA Frame . DATA Frame composed RX DATA Frame and TX DATA Frame. Users can select the default status, buffer save size, CMD, DATA SEND, and DATA RECEIVE during the control phase.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="spi-control-frame"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#spi-control-frame" title="Direct link to heading">#</a>SPI Control Frame</h3><p>TX BUFF AVAIL, RX DATA LEN, and INT STATUS must be read before users write or read data into WizFi360.
The SPI Control Frame sends 1Byte of control byte and reads 2Byte of status data.</p><ul><li>0x03(TX BUFF AVAIL) : checks whether the peer buffer is ready to write date before transmission.</li><li>0x02(RX DATA LEN) : reads the data length accumulated in the peer buffer before the data is received.</li><li>0x06(INT STATUS) : reads the interrupt status of slave.</li></ul><p><em>SPI Control Frame</em>
<img src="/Document/img/basic_guides/spi_guide/fig2_spi_control_frame.png"></p><p><em>SPI Timing Graph (SPI Control Frame)</em>
<img src="/Document/img/basic_guides/spi_guide/fig3_spi_timing_graph.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="at-cmd-frame"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#at-cmd-frame" title="Direct link to heading">#</a>AT CMD Frame</h3><p>The AT CMD frame reads the TX BUFF AVAIL from the <strong>SPI Control Frame</strong> and sets the Control Byte as 0x91 during the Control Phase if 0x0002 or bit 2 is high. Then the CMD length is set in units of 4bytes and AT CMD messages are included in the data for transmission. AT CMD reply uses the <strong>RX Data Frame</strong> method when receiving data. Please refer to the AT instruction set for more details on AT-CMD.</p><p><em>AT CMD Frame</em>
<img src="/Document/img/basic_guides/spi_guide/fig4_at_cmd_frame.png"></p><p><em>SPI Timing Graph (AT CMD Frame)</em>
<img src="/Document/img/basic_guides/spi_guide/fig5_spi_timing_graph.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="data-frame"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-frame" title="Direct link to heading">#</a>Data Frame</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tx-data-frame"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#tx-data-frame" title="Direct link to heading">#</a>TX Data Frame</h4><p>AT+CIPSEND, AT+CIPSENDEX, and AT+CIPSENDBUF must be transmitted from the <strong>AT CMD Frame</strong> and users must follow the next steps to prepare TCP or UDP data transmission in DATA trans mode.
The TX data frame reads the TX BUFF AVAIL from the <strong>SPI Control Frame</strong> and sets the Control Byte as 0x90 during the Control Phase if 0x0002 or bit 2 is high. Then the CMD length is set in units of 4bytes and DATA messages are included in the data for transmission. DATA reply uses the <strong>RX Data Frame</strong> method when receiving data. </p><p><em>TX Data Frame</em>
<img src="/Document/img/basic_guides/spi_guide/fig6_tx_data_frame.png"></p><p><em>SPI Timing Graph (TX DATA Frame)</em>
<img src="/Document/img/basic_guides/spi_guide/fig7.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="rx-data-frame"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#rx-data-frame" title="Direct link to heading">#</a>RX Data Frame</h4><p>When a reply or data is received after the <strong>AT CMD Frame</strong> is transmitted, check whether the interrupt pin is low or not. If the interrupt pin is low, users read the value of INT STATUS using the SPI Control Frame. If the value of INT STATUS is 0x0002 or bit 2 is high, users read the value of RX DATA LEN using the <strong>SPI Control Frame</strong>. And if the value of RX Data Len is not zero, users set the Control Byte as 0x10 during the control phase and read data. The total data count is the value of RX DATA LEN.</p><p><em>RX Data Frame</em>
<img src="/Document/img/basic_guides/spi_guide/fig8.png"></p><p><em>SPI Timing Graph (RX Data Frame)</em>
<img src="/Document/img/basic_guides/spi_guide/fig9.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="operation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#operation" title="Direct link to heading">#</a>Operation</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="at-cmd-operation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#at-cmd-operation" title="Direct link to heading">#</a>AT CMD Operation</h3><p>Use AT CMD to set WizFi360 or follow the steps below to set SEND mode and request data.</p><p><em>AT CMD Operation Flowchart</em>
<img src="/Document/img/basic_guides/spi_guide/fig10.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="data-operation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-operation" title="Direct link to heading">#</a>Data Operation</h3><p>Data can be sent if AT+CIPSEND, AT+CIPSENDEX, OR AT+CIPSENDBUF is entered in AT CMD or in DATA TRANS mode.</p><p><em>DATA Operation Flowchart</em>
<img src="/Document/img/basic_guides/spi_guide/fig11.png"></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/wizfi/Document/tree/master/docs/basic_guides/spi_guide.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Document/docs/basic_guides/firmware_upgrade"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« Firmware Upgrade Guide</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Document/docs/basic_guides/mqtt_client"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">MQTT Client »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#introduction" class="contents__link">Introduction</a></li><li><a href="#pinout" class="contents__link">Pinout</a></li><li><a href="#spi-frame-format" class="contents__link">SPI Frame Format</a><ul><li><a href="#spi-control-frame" class="contents__link">SPI Control Frame</a></li><li><a href="#at-cmd-frame" class="contents__link">AT CMD Frame</a></li><li><a href="#data-frame" class="contents__link">Data Frame</a></li></ul></li><li><a href="#operation" class="contents__link">Operation</a><ul><li><a href="#at-cmd-operation" class="contents__link">AT CMD Operation</a></li><li><a href="#data-operation" class="contents__link">Data Operation</a></li></ul></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Document/docs/intro">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/Document/docs/basic_guides/firmware_upgrade">Application guides</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://forum.wiznet.io">WIZnet Forum</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="http://maker.wiznet.io/">WIZnet Maker</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Family Site</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Document/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://wiznet.io">WIZnet</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 WIZnet Co., Ltd. All Rights Reserved.</div></div></div></footer>
</div>

<script src="/Document/styles.0ed8d793.js"></script>

<script src="/Document/runtime~main.433e52dc.js"></script>

<script src="/Document/main.ef26d2e9.js"></script>

<script src="/Document/1.612e01d4.js"></script>

<script src="/Document/2.b0a41411.js"></script>

<script src="/Document/3.d193d8dc.js"></script>

<script src="/Document/1be78505.d534d536.js"></script>

<script src="/Document/2d31042b.173b4481.js"></script>

<script src="/Document/17896441.83a3dab4.js"></script>

<script src="/Document/62ef5692.8fdf17e9.js"></script>


</body>
</html>